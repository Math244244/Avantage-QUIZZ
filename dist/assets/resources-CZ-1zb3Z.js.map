{"version":3,"file":"resources-CZ-1zb3Z.js","sources":["../../js/empty-states.js","../../js/resources.js"],"sourcesContent":["// Empty States - Helper pour afficher des √©tats vides avec illustrations SVG\r\n/**\r\n * empty-states.js - Gestion centralis√©e des √©tats vides\r\n * \r\n * Illustrations SVG inline pour:\r\n * - Aucune question\r\n * - Aucun r√©sultat\r\n * - Aucune ressource\r\n * - Aucun utilisateur\r\n * - Aucune notification\r\n * - Erreurs g√©n√©riques\r\n */\r\n\r\n/**\r\n * Illustrations SVG\r\n */\r\nconst illustrations = {\r\n    // Aucune question cr√©√©e\r\n    noQuestions: `\r\n        <svg class=\"w-32 h-32 mx-auto mb-6 text-slate-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" \r\n                d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\">\r\n            </path>\r\n            <circle cx=\"12\" cy=\"12\" r=\"1.5\" fill=\"currentColor\" opacity=\"0.3\"/>\r\n        </svg>\r\n    `,\r\n    \r\n    // Aucun r√©sultat de quiz\r\n    noResults: `\r\n        <svg class=\"w-32 h-32 mx-auto mb-6 text-blue-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" \r\n                d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\">\r\n            </path>\r\n            <line x1=\"6\" y1=\"15\" x2=\"6\" y2=\"19\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" opacity=\"0.5\"/>\r\n            <line x1=\"12\" y1=\"11\" x2=\"12\" y2=\"19\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" opacity=\"0.5\"/>\r\n            <line x1=\"18\" y1=\"7\" x2=\"18\" y2=\"19\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" opacity=\"0.5\"/>\r\n        </svg>\r\n    `,\r\n    \r\n    // Aucune ressource disponible\r\n    noResources: `\r\n        <svg class=\"w-32 h-32 mx-auto mb-6 text-green-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" \r\n                d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\">\r\n            </path>\r\n            <circle cx=\"7\" cy=\"10\" r=\"1\" fill=\"currentColor\" opacity=\"0.3\"/>\r\n            <circle cx=\"17\" cy=\"10\" r=\"1\" fill=\"currentColor\" opacity=\"0.3\"/>\r\n        </svg>\r\n    `,\r\n    \r\n    // Aucun utilisateur trouv√©\r\n    noUsers: `\r\n        <svg class=\"w-32 h-32 mx-auto mb-6 text-slate-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" \r\n                d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\">\r\n            </path>\r\n        </svg>\r\n    `,\r\n    \r\n    // Aucune notification\r\n    noNotifications: `\r\n        <svg class=\"w-32 h-32 mx-auto mb-6 text-orange-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" \r\n                d=\"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\">\r\n            </path>\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" \r\n                d=\"M9.5 9.5l5 5m0-5l-5 5\" opacity=\"0.3\">\r\n            </path>\r\n        </svg>\r\n    `,\r\n    \r\n    // Erreur g√©n√©rique\r\n    error: `\r\n        <svg class=\"w-32 h-32 mx-auto mb-6 text-red-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" \r\n                d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\">\r\n            </path>\r\n            <circle cx=\"12\" cy=\"15\" r=\"1\" fill=\"currentColor\"/>\r\n        </svg>\r\n    `,\r\n    \r\n    // Chargement en cours\r\n    loading: `\r\n        <svg class=\"w-32 h-32 mx-auto mb-6 text-ap-red-primary animate-pulse\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" \r\n                d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\">\r\n            </path>\r\n        </svg>\r\n    `,\r\n    \r\n    // Recherche sans r√©sultat\r\n    noSearchResults: `\r\n        <svg class=\"w-32 h-32 mx-auto mb-6 text-slate-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" \r\n                d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\">\r\n            </path>\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" \r\n                d=\"M9 9l6 6m0-6l-6 6\" opacity=\"0.3\">\r\n            </path>\r\n        </svg>\r\n    `\r\n};\r\n\r\n/**\r\n * Configuration des messages par type\r\n */\r\nconst emptyStateConfig = {\r\n    noQuestions: {\r\n        title: 'Aucune question cr√©√©e',\r\n        description: 'Commencez par cr√©er votre premi√®re question ou importez un fichier JSON',\r\n        illustration: illustrations.noQuestions,\r\n        action: {\r\n            text: '‚ûï Cr√©er une question',\r\n            show: true\r\n        }\r\n    },\r\n    noResults: {\r\n        title: 'Aucun quiz compl√©t√©',\r\n        description: 'Commencez votre premier quiz pour voir vos r√©sultats ici',\r\n        illustration: illustrations.noResults,\r\n        action: {\r\n            text: 'üéØ Commencer un quiz',\r\n            show: true,\r\n            href: 'index.html'\r\n        }\r\n    },\r\n    noResources: {\r\n        title: 'Aucune ressource disponible',\r\n        description: 'Les documents et ressources seront ajout√©s prochainement',\r\n        illustration: illustrations.noResources,\r\n        action: {\r\n            show: false\r\n        }\r\n    },\r\n    noUsers: {\r\n        title: 'Aucun utilisateur trouv√©',\r\n        description: 'Cr√©ez votre premier utilisateur pour commencer',\r\n        illustration: illustrations.noUsers,\r\n        action: {\r\n            text: 'üë§ Cr√©er un utilisateur',\r\n            show: true\r\n        }\r\n    },\r\n    noNotifications: {\r\n        title: 'Aucune notification',\r\n        description: 'Vous √™tes √† jour ! Aucune nouvelle notification pour le moment.',\r\n        illustration: illustrations.noNotifications,\r\n        action: {\r\n            show: false\r\n        }\r\n    },\r\n    error: {\r\n        title: 'Une erreur est survenue',\r\n        description: 'Impossible de charger les donn√©es. Veuillez r√©essayer.',\r\n        illustration: illustrations.error,\r\n        action: {\r\n            text: 'üîÑ R√©essayer',\r\n            show: true\r\n        }\r\n    },\r\n    noSearchResults: {\r\n        title: 'Aucun r√©sultat trouv√©',\r\n        description: 'Essayez avec d\\'autres mots-cl√©s ou filtres',\r\n        illustration: illustrations.noSearchResults,\r\n        action: {\r\n            text: 'üîç R√©initialiser les filtres',\r\n            show: true\r\n        }\r\n    },\r\n    loading: {\r\n        title: 'Chargement en cours...',\r\n        description: 'Veuillez patienter pendant le chargement des donn√©es',\r\n        illustration: illustrations.loading,\r\n        action: {\r\n            show: false\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Cr√©er un √©tat vide HTML\r\n * @param {string} type - Type d'√©tat vide (noQuestions, noResults, etc.)\r\n * @param {object} options - Options de personnalisation\r\n * @returns {string} HTML de l'√©tat vide\r\n */\r\nexport function createEmptyState(type, options = {}) {\r\n    const config = emptyStateConfig[type];\r\n    if (!config) {\r\n        console.error(`Type d'√©tat vide inconnu: ${type}`);\r\n        return '';\r\n    }\r\n    \r\n    const title = options.title || config.title;\r\n    const description = options.description || config.description;\r\n    const illustration = options.illustration || config.illustration;\r\n    const action = options.action !== undefined ? options.action : config.action;\r\n    \r\n    return `\r\n        <div class=\"empty-state text-center py-16 px-6\">\r\n            ${illustration}\r\n            <h3 class=\"text-2xl font-bold text-slate-700 mb-3\">\r\n                ${title}\r\n            </h3>\r\n            <p class=\"text-slate-500 mb-6 max-w-md mx-auto\">\r\n                ${description}\r\n            </p>\r\n            ${action.show ? `\r\n                <button \r\n                    class=\"empty-state-action px-6 py-3 bg-ap-red-primary text-white rounded-lg font-medium hover:bg-ap-red-dark transition-all hover:shadow-lg hover:-translate-y-0.5\"\r\n                    ${action.href ? `onclick=\"window.location.href='${action.href}'\"` : ''}\r\n                >\r\n                    ${action.text}\r\n                </button>\r\n            ` : ''}\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Afficher un √©tat vide dans un conteneur\r\n * @param {string} containerId - ID du conteneur\r\n * @param {string} type - Type d'√©tat vide\r\n * @param {object} options - Options de personnalisation\r\n */\r\nexport function showEmptyState(containerId, type, options = {}) {\r\n    const container = document.getElementById(containerId);\r\n    if (!container) {\r\n        console.error(`Conteneur non trouv√©: ${containerId}`);\r\n        return;\r\n    }\r\n    \r\n    container.innerHTML = createEmptyState(type, options);\r\n    \r\n    // Animation d'apparition\r\n    const emptyState = container.querySelector('.empty-state');\r\n    if (emptyState) {\r\n        emptyState.style.opacity = '0';\r\n        emptyState.style.transform = 'translateY(20px)';\r\n        \r\n        setTimeout(() => {\r\n            emptyState.style.transition = 'all 400ms ease-out';\r\n            emptyState.style.opacity = '1';\r\n            emptyState.style.transform = 'translateY(0)';\r\n        }, 10);\r\n    }\r\n}\r\n\r\n/**\r\n * Cr√©er un √©tat d'erreur personnalis√©\r\n * @param {string} message - Message d'erreur\r\n * @param {function} onRetry - Callback pour le bouton r√©essayer\r\n * @returns {string} HTML de l'erreur\r\n */\r\nexport function createErrorState(message, onRetry = null) {\r\n    const retryId = `retry-btn-${Math.random().toString(36).substr(2, 9)}`;\r\n    \r\n    const html = `\r\n        <div class=\"empty-state text-center py-16 px-6\">\r\n            ${illustrations.error}\r\n            <h3 class=\"text-2xl font-bold text-red-600 mb-3\">\r\n                Une erreur est survenue\r\n            </h3>\r\n            <p class=\"text-slate-600 mb-6 max-w-md mx-auto\">\r\n                ${message}\r\n            </p>\r\n            ${onRetry ? `\r\n                <button \r\n                    id=\"${retryId}\"\r\n                    class=\"px-6 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-all hover:shadow-lg hover:-translate-y-0.5\"\r\n                >\r\n                    üîÑ R√©essayer\r\n                </button>\r\n            ` : ''}\r\n        </div>\r\n    `;\r\n    \r\n    // Attacher le callback apr√®s insertion dans le DOM\r\n    if (onRetry) {\r\n        setTimeout(() => {\r\n            const btn = document.getElementById(retryId);\r\n            if (btn) {\r\n                btn.addEventListener('click', onRetry);\r\n            }\r\n        }, 10);\r\n    }\r\n    \r\n    return html;\r\n}\r\n\r\n/**\r\n * Afficher un √©tat d'erreur dans un conteneur\r\n * @param {string} containerId - ID du conteneur\r\n * @param {string} message - Message d'erreur\r\n * @param {function} onRetry - Callback pour le bouton r√©essayer\r\n */\r\nexport function showErrorState(containerId, message, onRetry = null) {\r\n    const container = document.getElementById(containerId);\r\n    if (!container) {\r\n        console.error(`Conteneur non trouv√©: ${containerId}`);\r\n        return;\r\n    }\r\n    \r\n    container.innerHTML = createErrorState(message, onRetry);\r\n}\r\n\r\n/**\r\n * Helper pour remplacer les √©tats vides existants\r\n * Recherche et remplace les divs avec certaines classes\r\n */\r\nexport function upgradeExistingEmptyStates() {\r\n    // Rechercher les anciens √©tats vides (texte simple)\r\n    const oldEmptyStates = document.querySelectorAll('[data-empty-state-type]');\r\n    \r\n    oldEmptyStates.forEach(element => {\r\n        const type = element.dataset.emptyStateType;\r\n        const containerId = element.id || `empty-${Math.random().toString(36).substr(2, 9)}`;\r\n        element.id = containerId;\r\n        \r\n        showEmptyState(containerId, type);\r\n    });\r\n}\r\n\r\n// Export des illustrations pour utilisation directe\r\nexport { illustrations };\r\n\r\n// Initialiser automatiquement au chargement\r\nif (typeof window !== 'undefined') {\r\n    window.addEventListener('DOMContentLoaded', () => {\r\n        upgradeExistingEmptyStates();\r\n    });\r\n}\r\n\r\n// Rendre accessible globalement\r\nif (typeof window !== 'undefined') {\r\n    window.EmptyStates = {\r\n        create: createEmptyState,\r\n        show: showEmptyState,\r\n        createError: createErrorState,\r\n        showError: showErrorState,\r\n        illustrations\r\n    };\r\n}\r\n","// Page Ressources - Gestion de la biblioth√®que de documents\r\nimport { db } from './firebase-config.js';\r\nimport { collection, query, orderBy, getDocs, addDoc, deleteDoc, doc, where } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';\r\nimport { getCurrentUser, onAuthChange, signOutUser } from './auth.js';\r\nimport { toast } from './toast.js';\r\n// ‚úÖ CORRECTION SECTION 4 : Protection XSS\r\nimport { escapeHtml } from './security.js';\r\n// ‚úÖ P0 CRITIQUE: Import pour validation stricte du clientId\r\nimport { getCurrentClientId } from './client-manager.js';\r\nimport {\r\n    createResourceSkeleton,\r\n    showSkeleton,\r\n    hideSkeleton\r\n} from './skeleton.js';\r\nimport { showEmptyState } from './empty-states.js';\r\n\r\n// √âtat\r\nlet allResources = [];\r\nlet filteredResources = [];\r\nlet isAdmin = false;\r\n\r\n// Configuration\r\nconst categoryNames = {\r\n    'guides': { name: 'Guides', icon: 'üìñ', color: 'blue' },\r\n    'manuels': { name: 'Manuels', icon: 'üìã', color: 'green' },\r\n    'reglements': { name: 'R√®glements', icon: 'üõ°Ô∏è', color: 'orange' },\r\n    'formulaires': { name: 'Formulaires', icon: 'üìù', color: 'red' },\r\n    'videos': { name: 'Vid√©os', icon: 'üé•', color: 'red' }\r\n};\r\n\r\nconst moduleNames = {\r\n    'tous': 'Tous les modules',\r\n    'auto': 'AT-AVE-AVEX',\r\n    'loisir': 'VTT, Motoneige, etc.',\r\n    'vr': 'V√©hicules R√©cr√©atifs',\r\n    'tracteur': '√âquipement Agricole'\r\n};\r\n\r\n// Initialisation\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n    // V√©rifier l'authentification Firebase\r\n    onAuthChange(async (user) => {\r\n        if (!user) {\r\n            window.location.href = '/index.html';\r\n            return;\r\n        }\r\n        \r\n        updateUserInfo(user);\r\n        await checkAdminStatus(user.uid);\r\n        await loadResources();\r\n    });\r\n    \r\n    // √âv√©nements\r\n    document.getElementById('logout-btn')?.addEventListener('click', handleLogout);\r\n    document.getElementById('signout-link')?.addEventListener('click', handleLogout);\r\n    document.getElementById('search-input')?.addEventListener('input', applyFilters);\r\n    document.getElementById('filter-category')?.addEventListener('change', applyFilters);\r\n    document.getElementById('filter-module')?.addEventListener('change', applyFilters);\r\n    document.getElementById('reset-filters-btn')?.addEventListener('click', resetFilters);\r\n    document.getElementById('upload-btn')?.addEventListener('click', showUploadModal);\r\n    document.getElementById('cancel-upload-btn')?.addEventListener('click', hideUploadModal);\r\n    document.getElementById('upload-form')?.addEventListener('submit', handleUpload);\r\n});\r\n\r\n// Mettre √† jour les infos utilisateur\r\nfunction updateUserInfo(user) {\r\n    // Anciens IDs (top nav - supprimer si pr√©sents)\r\n    if (document.getElementById('user-name')) {\r\n        document.getElementById('user-name').textContent = user.displayName || user.email;\r\n    }\r\n    if (document.getElementById('user-photo')) {\r\n        document.getElementById('user-photo').src = user.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.displayName || user.email)}`;\r\n    }\r\n    \r\n    // Nouveaux IDs (sidebar)\r\n    if (document.getElementById('user-display-name')) {\r\n        document.getElementById('user-display-name').textContent = user.displayName || user.email;\r\n    }\r\n    if (document.getElementById('user-avatar')) {\r\n        document.getElementById('user-avatar').src = user.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.displayName || user.email)}`;\r\n    }\r\n}\r\n\r\n// V√©rifier si l'utilisateur est admin\r\nasync function checkAdminStatus(userId) {\r\n    try {\r\n        const userDoc = await getDocs(query(collection(db, 'users'), where('uid', '==', userId)));\r\n        if (!userDoc.empty) {\r\n            const userData = userDoc.docs[0].data();\r\n            isAdmin = userData.role === 'admin';\r\n            \r\n            if (isAdmin) {\r\n                document.getElementById('admin-section')?.classList.remove('hidden');\r\n                document.getElementById('nav-admin-item')?.classList.remove('hidden');\r\n                document.getElementById('admin-badge-nav')?.classList.remove('hidden');\r\n            }\r\n        }\r\n    } catch (error) {\r\n        console.error('Erreur lors de la v√©rification du r√¥le:', error);\r\n    }\r\n}\r\n\r\n// Charger les ressources depuis Firestore\r\nasync function loadResources() {\r\n    console.log('üì• Chargement des ressources...');\r\n    \r\n    try {\r\n        // Afficher skeleton pendant le chargement\r\n        const container = document.getElementById('resources-container');\r\n        if (container) {\r\n            showSkeleton('resources-container', createResourceSkeleton(6));\r\n        }\r\n        \r\n        // ‚úÖ P0 CRITIQUE: Filtrer par clientId pour isolation multi-tenant\r\n        const clientId = await getCurrentClientId();\r\n        const q = query(\r\n            collection(db, 'resources'), \r\n            where('clientId', '==', clientId),\r\n            orderBy('createdAt', 'desc')\r\n        );\r\n        const querySnapshot = await getDocs(q);\r\n        \r\n        allResources = [];\r\n        querySnapshot.forEach((doc) => {\r\n            allResources.push({\r\n                id: doc.id,\r\n                ...doc.data(),\r\n                createdAt: doc.data().createdAt?.toDate()\r\n            });\r\n        });\r\n        \r\n        console.log(`‚úÖ ${allResources.length} ressources charg√©es`);\r\n        \r\n        if (allResources.length === 0) {\r\n            showNoResources();\r\n        } else {\r\n            filteredResources = [...allResources];\r\n            renderResources();\r\n        }\r\n        \r\n        document.getElementById('resources-loading')?.classList.add('hidden');\r\n        \r\n    } catch (error) {\r\n        console.error('‚ùå Erreur lors du chargement des ressources:', error);\r\n        toast.error('Erreur lors du chargement des ressources');\r\n        // Si la collection n'existe pas encore, afficher le message\r\n        showNoResources();\r\n        document.getElementById('resources-loading')?.classList.add('hidden');\r\n    }\r\n}\r\n\r\n// Restaurer la structure HTML si elle a √©t√© remplac√©e par un √©tat vide\r\nfunction restoreResourcesContainerStructure() {\r\n    const container = document.getElementById('resources-container');\r\n    if (!container) return;\r\n    \r\n    // V√©rifier si le conteneur a d√©j√† la bonne structure (grid)\r\n    if (container.classList.contains('grid')) return;\r\n    \r\n    // Restaurer la structure HTML avec les classes n√©cessaires\r\n    container.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6';\r\n}\r\n\r\n// Afficher les ressources\r\nfunction renderResources() {\r\n    const container = document.getElementById('resources-container');\r\n    \r\n    if (filteredResources.length === 0) {\r\n        showNoResources();\r\n        return;\r\n    }\r\n    \r\n    // Restaurer la structure HTML si n√©cessaire\r\n    restoreResourcesContainerStructure();\r\n    \r\n    container.classList.remove('hidden');\r\n    document.getElementById('no-resources')?.classList.add('hidden');\r\n    \r\n    // ‚úÖ CORRECTION SECTION 4 : Protection XSS - √âchapper toutes les donn√©es utilisateur\r\n    container.innerHTML = filteredResources.map(resource => {\r\n        const category = categoryNames[resource.category] || { name: resource.category, icon: 'üìÑ', color: 'gray' };\r\n        const date = resource.createdAt \r\n            ? new Date(resource.createdAt).toLocaleDateString('fr-FR')\r\n            : 'Date inconnue';\r\n        \r\n        // √âchapper toutes les donn√©es utilisateur\r\n        const safeTitle = escapeHtml(resource.title || '');\r\n        const safeDescription = escapeHtml(resource.description || 'Aucune description');\r\n        const safeCategoryName = escapeHtml(category.name);\r\n        const safeModuleName = escapeHtml(moduleNames[resource.module] || resource.module || '');\r\n        const safeDate = escapeHtml(date);\r\n        const safeResourceId = escapeHtml(resource.id);\r\n        // URL doit √™tre valid√©e avec sanitizeURL, mais pour l'instant on √©chappe juste l'affichage\r\n        const safeUrl = escapeHtml(resource.url || '#');\r\n        const safeDownloads = resource.downloads ? escapeHtml(String(resource.downloads)) : '';\r\n        \r\n        return `\r\n            <div class=\"file-card bg-white rounded-xl shadow-md hover:shadow-xl transition-all overflow-hidden fade-in\">\r\n                <div class=\"p-6\">\r\n                    <div class=\"flex items-start justify-between mb-4\">\r\n                        <div class=\"file-icon text-4xl\">${category.icon}</div>\r\n                        ${isAdmin ? `\r\n                            <button onclick=\"deleteResource('${safeResourceId}')\" class=\"text-red-600 hover:text-red-800 transition-colors\">\r\n                                <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"></path>\r\n                                </svg>\r\n                            </button>\r\n                        ` : ''}\r\n                    </div>\r\n                    \r\n                    <h3 class=\"text-lg font-bold text-slate-900 mb-2\">${safeTitle}</h3>\r\n                    <p class=\"text-sm text-slate-600 mb-4 line-clamp-2\">${safeDescription}</p>\r\n                    \r\n                    <div class=\"flex flex-wrap gap-2 mb-4\">\r\n                        <span class=\"px-3 py-1 bg-${category.color}-100 text-${category.color}-700 text-xs font-medium rounded-full\">\r\n                            ${safeCategoryName}\r\n                        </span>\r\n                        <span class=\"px-3 py-1 bg-slate-100 text-slate-700 text-xs font-medium rounded-full\">\r\n                            ${safeModuleName}\r\n                        </span>\r\n                    </div>\r\n                    \r\n                    <div class=\"flex items-center justify-between text-xs text-slate-500 mb-4\">\r\n                        <span>üìÖ ${safeDate}</span>\r\n                        ${safeDownloads ? `<span>‚¨áÔ∏è ${safeDownloads} t√©l√©chargements</span>` : ''}\r\n                    </div>\r\n                    \r\n                    <div class=\"flex gap-2\">\r\n                        <a href=\"${safeUrl}\" target=\"_blank\" rel=\"noopener noreferrer\" \r\n                           class=\"flex-1 bg-ap-red-primary text-white px-4 py-2 rounded-lg hover:bg-ap-red-dark transition-colors font-medium text-center text-sm\">\r\n                            üì• T√©l√©charger\r\n                        </a>\r\n                        <a href=\"${safeUrl}\" target=\"_blank\" rel=\"noopener noreferrer\" \r\n                           class=\"px-4 py-2 border-2 border-ap-red-primary text-ap-red-primary rounded-lg hover:bg-ap-red-50 transition-colors font-medium text-center text-sm\">\r\n                            üëÅÔ∏è\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }).join('');\r\n}\r\n\r\n// Appliquer les filtres\r\nfunction applyFilters() {\r\n    const searchTerm = document.getElementById('search-input').value.toLowerCase();\r\n    const categoryFilter = document.getElementById('filter-category').value;\r\n    const moduleFilter = document.getElementById('filter-module').value;\r\n    \r\n    filteredResources = allResources.filter(resource => {\r\n        const matchSearch = !searchTerm || \r\n            resource.title.toLowerCase().includes(searchTerm) || \r\n            (resource.description && resource.description.toLowerCase().includes(searchTerm));\r\n        \r\n        const matchCategory = !categoryFilter || resource.category === categoryFilter;\r\n        const matchModule = !moduleFilter || resource.module === moduleFilter;\r\n        \r\n        return matchSearch && matchCategory && matchModule;\r\n    });\r\n    \r\n    renderResources();\r\n}\r\n\r\n// R√©initialiser les filtres\r\nfunction resetFilters() {\r\n    document.getElementById('search-input').value = '';\r\n    document.getElementById('filter-category').value = '';\r\n    document.getElementById('filter-module').value = '';\r\n    filteredResources = [...allResources];\r\n    renderResources();\r\n}\r\n\r\n// Filtrer par cat√©gorie (boutons rapides)\r\nwindow.filterByCategory = function(category) {\r\n    document.getElementById('filter-category').value = category;\r\n    applyFilters();\r\n};\r\n\r\n// Afficher la modal d'upload\r\nfunction showUploadModal() {\r\n    document.getElementById('upload-modal')?.classList.remove('hidden');\r\n}\r\n\r\n// Cacher la modal d'upload\r\nfunction hideUploadModal() {\r\n    document.getElementById('upload-modal')?.classList.add('hidden');\r\n    document.getElementById('upload-form')?.reset();\r\n}\r\n\r\n// G√©rer l'upload\r\nasync function handleUpload(e) {\r\n    e.preventDefault();\r\n    \r\n    if (!isAdmin) {\r\n        toast.error('Acc√®s refus√© : vous devez √™tre administrateur');\r\n        return;\r\n    }\r\n    \r\n    const title = document.getElementById('doc-title').value;\r\n    const description = document.getElementById('doc-description').value;\r\n    const category = document.getElementById('doc-category').value;\r\n    const module = document.getElementById('doc-module').value;\r\n    const url = document.getElementById('doc-url').value;\r\n    \r\n    if (!title || !category || !module || !url) {\r\n        toast.error('Veuillez remplir tous les champs obligatoires');\r\n        return;\r\n    }\r\n    \r\n    const loadingToast = toast.showLoadingToast('Ajout du document...');\r\n    \r\n    try {\r\n        console.log('üì§ Ajout d\\'une nouvelle ressource...');\r\n        \r\n        const user = getCurrentUser();\r\n        // ‚úÖ P0 CRITIQUE: Ajouter clientId pour isolation multi-tenant\r\n        const clientId = await getCurrentClientId();\r\n        await addDoc(collection(db, 'resources'), {\r\n            title,\r\n            description,\r\n            category,\r\n            module,\r\n            url,\r\n            clientId: clientId, // ‚úÖ P0 CRITIQUE: Isolation multi-tenant\r\n            downloads: 0,\r\n            createdAt: new Date(),\r\n            createdBy: user.uid\r\n        });\r\n        \r\n        console.log('‚úÖ Ressource ajout√©e avec succ√®s');\r\n        toast.updateLoadingToast(loadingToast, 'Document ajout√© avec succ√®s !', 'success');\r\n        \r\n        hideUploadModal();\r\n        await loadResources();\r\n        \r\n    } catch (error) {\r\n        console.error('‚ùå Erreur lors de l\\'ajout de la ressource:', error);\r\n        toast.updateLoadingToast(loadingToast, 'Erreur d\\'ajout', 'error');\r\n        toast.error('Erreur lors de l\\'ajout du document', 4000);\r\n    }\r\n}\r\n\r\n// Supprimer une ressource\r\nwindow.deleteResource = async function(resourceId) {\r\n    if (!isAdmin) {\r\n        toast.error('Acc√®s refus√©');\r\n        return;\r\n    }\r\n    \r\n    if (!confirm('Voulez-vous vraiment supprimer ce document ?')) {\r\n        toast.info('Suppression annul√©e', 2000);\r\n        return;\r\n    }\r\n    \r\n    const loadingToast = toast.showLoadingToast('Suppression du document...');\r\n    \r\n    try {\r\n        console.log('üóëÔ∏è Suppression de la ressource:', resourceId);\r\n        await deleteDoc(doc(db, 'resources', resourceId));\r\n        console.log('‚úÖ Ressource supprim√©e');\r\n        \r\n        toast.updateLoadingToast(loadingToast, 'Document supprim√© avec succ√®s !', 'success');\r\n        \r\n        await loadResources();\r\n        \r\n    } catch (error) {\r\n        console.error('‚ùå Erreur lors de la suppression:', error);\r\n        toast.updateLoadingToast(loadingToast, 'Erreur de suppression', 'error');\r\n        toast.error('Erreur lors de la suppression', 4000);\r\n    }\r\n};\r\n\r\n// Afficher message si aucune ressource\r\nfunction showNoResources() {\r\n    document.getElementById('resources-loading')?.classList.add('hidden');\r\n    document.getElementById('no-resources')?.classList.add('hidden');\r\n    \r\n    // Utiliser le composant empty-states pour un rendu professionnel\r\n    const container = document.getElementById('resources-container');\r\n    if (container) {\r\n        container.classList.remove('hidden');\r\n        showEmptyState('resources-container', 'noResources');\r\n    }\r\n}\r\n\r\n// D√©connexion\r\nasync function handleLogout() {\r\n    try {\r\n        await signOutUser();\r\n        window.location.href = '/';\r\n    } catch (error) {\r\n        console.error('Erreur lors de la d√©connexion:', error);\r\n    }\r\n}\r\n"],"names":["illustrations","emptyStateConfig","createEmptyState","type","options","config","title","description","illustration","action","showEmptyState","containerId","container","emptyState","createErrorState","message","onRetry","retryId","html","btn","showErrorState","upgradeExistingEmptyStates","element","allResources","filteredResources","isAdmin","categoryNames","moduleNames","onAuthChange","user","updateUserInfo","checkAdminStatus","loadResources","handleLogout","applyFilters","resetFilters","showUploadModal","hideUploadModal","handleUpload","userId","userDoc","getDocs","query","collection","db","where","error","showSkeleton","createResourceSkeleton","clientId","getCurrentClientId","q","orderBy","querySnapshot","doc","showNoResources","renderResources","toast","restoreResourcesContainerStructure","resource","category","date","safeTitle","escapeHtml","safeDescription","safeCategoryName","safeModuleName","safeDate","safeResourceId","safeUrl","safeDownloads","searchTerm","categoryFilter","moduleFilter","matchSearch","matchCategory","matchModule","module","url","loadingToast","getCurrentUser","addDoc","resourceId","deleteDoc","signOutUser"],"mappings":"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"}