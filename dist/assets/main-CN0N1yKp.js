const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/services-C8kBvepO.js","assets/admin-BrAXV1ch.js","assets/quiz-CT_T8PGH.js"])))=>i.map(i=>d[i]);
import"./micro-interactions-B30Iqapx.js";import{t as k,_ as F,s as P,p as C,u as I,j as S,o as z,g as A,q as O,e as w}from"./admin-BrAXV1ch.js";import{t as T,b as $}from"./quiz-CT_T8PGH.js";import{l as q,s as m,M as _,g as R,m as H,n as N,o as j,p as U}from"./services-C8kBvepO.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-functions.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";const Q="avantage-quizz-sync",V=1,u="sync-queue";let p=null;async function f(){return p||new Promise((t,e)=>{const o=indexedDB.open(Q,V);o.onerror=()=>e(o.error),o.onsuccess=()=>{p=o.result,t(p)},o.onupgradeneeded=n=>{const s=n.target.result;if(!s.objectStoreNames.contains(u)){const a=s.createObjectStore(u,{keyPath:"id",autoIncrement:!0});a.createIndex("timestamp","timestamp",{unique:!1}),a.createIndex("type","type",{unique:!1}),a.createIndex("status","status",{unique:!1})}}})}class G{constructor(){this.isProcessing=!1,this.listeners=new Set}async add(e,o,n={}){await f();const s={type:e,operation:this.serializeOperation(o),data:n,timestamp:Date.now(),status:"pending",retries:0,maxRetries:3};return new Promise((a,i)=>{const c=p.transaction([u],"readwrite").objectStore(u).add(s);c.onsuccess=()=>{const d=c.result;console.log(`üì• Op√©ration ajout√©e √† la file d'attente: ${e} (ID: ${d})`),this.notifyListeners("added",{id:d,type:e}),a(d)},c.onerror=()=>i(c.error)})}serializeOperation(e){return{name:e.name||"anonymous"}}async getAll(){return await f(),new Promise((e,o)=>{const i=p.transaction([u],"readonly").objectStore(u).index("status").getAll("pending");i.onsuccess=()=>e(i.result),i.onerror=()=>o(i.error)})}async markCompleted(e){return await f(),new Promise((o,n)=>{const a=p.transaction([u],"readwrite").objectStore(u),i=a.get(e);i.onsuccess=()=>{const l=i.result;if(l){l.status="completed";const r=a.put(l);r.onsuccess=()=>{console.log(`‚úÖ Op√©ration compl√©t√©e: ${l.type} (ID: ${e})`),this.notifyListeners("completed",{id:e,type:l.type}),o()},r.onerror=()=>n(r.error)}else o()},i.onerror=()=>n(i.error)})}async markFailed(e,o){return await f(),new Promise((n,s)=>{const i=p.transaction([u],"readwrite").objectStore(u),l=i.get(e);l.onsuccess=()=>{const r=l.result;if(r){r.retries++,r.retries>=r.maxRetries?(r.status="failed",r.error=o?.message||"Unknown error"):r.status="pending";const c=i.put(r);c.onsuccess=()=>{r.status==="failed"?(console.error(`‚ùå Op√©ration √©chou√©e d√©finitivement: ${r.type} (ID: ${e})`),this.notifyListeners("failed",{id:e,type:r.type,error:o})):console.warn(`‚ö†Ô∏è Op√©ration √©chou√©e, r√©essai ${r.retries}/${r.maxRetries}: ${r.type} (ID: ${e})`),n()},c.onerror=()=>s(c.error)}else n()},l.onerror=()=>s(l.error)})}async remove(e){return await f(),new Promise((o,n)=>{const i=p.transaction([u],"readwrite").objectStore(u).delete(e);i.onsuccess=()=>{console.log(`üóëÔ∏è Op√©ration supprim√©e: ID ${e}`),o()},i.onerror=()=>n(i.error)})}async processQueue(e={}){if(this.isProcessing){console.log("‚è≥ Traitement d√©j√† en cours...");return}if(!navigator.onLine){console.log("üì¥ Hors ligne, synchronisation report√©e");return}this.isProcessing=!0,console.log("üîÑ D√©but du traitement de la file d'attente...");try{const o=await this.getAll();if(o.length===0)return console.log("‚úÖ Aucune op√©ration en attente"),this.isProcessing=!1,{success:0,failed:0};console.log(`üìã ${o.length} op√©ration(s) en attente`);let n=0,s=0;for(const a of o)try{const i=e[a.type];if(!i){console.warn(`‚ö†Ô∏è Aucun handler pour le type: ${a.type}`),await this.markFailed(a.id,new Error(`No handler for type: ${a.type}`)),s++;continue}await i(a.data),await this.markCompleted(a.id),await this.remove(a.id),n++}catch(i){console.error(`‚ùå Erreur traitement op√©ration ${a.id}:`,i),await this.markFailed(a.id,i),s++}return console.log(`‚úÖ Traitement termin√©: ${n} r√©ussies, ${s} √©chou√©es`),this.notifyListeners("processed",{success:n,failed:s}),{success:n,failed:s}}catch(o){throw console.error("‚ùå Erreur traitement file d'attente:",o),o}finally{this.isProcessing=!1}}async getStats(){return await f(),new Promise((e,o)=>{const a=p.transaction([u],"readonly").objectStore(u).getAll();a.onsuccess=()=>{const i=a.result,l={total:i.length,pending:i.filter(r=>r.status==="pending").length,completed:i.filter(r=>r.status==="completed").length,failed:i.filter(r=>r.status==="failed").length};e(l)},a.onerror=()=>o(a.error)})}async cleanCompleted(){await f();const e=Date.now()-10080*60*1e3;return new Promise((o,n)=>{const l=p.transaction([u],"readwrite").objectStore(u).index("timestamp").openCursor();let r=0;l.onsuccess=c=>{const d=c.target.result;if(d){const v=d.value;v.status==="completed"&&v.timestamp<e&&(d.delete(),r++),d.continue()}else console.log(`üßπ ${r} op√©ration(s) compl√©t√©e(s) nettoy√©e(s)`),o(r)},l.onerror=()=>n(l.error)})}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(e,o){this.listeners.forEach(n=>{try{n(e,o)}catch(s){console.error("Erreur listener:",s)}})}}const B=new G;f().catch(t=>{console.error("‚ùå Erreur initialisation IndexedDB:",t)});const xe=Object.freeze(Object.defineProperty({__proto__:null,syncQueue:B},Symbol.toStringTag,{value:"Module"}));class W{constructor(){this.isOnline=navigator.onLine,this.listeners=new Set,this.indicatorElement=null,this.setupEventListeners(),this.createIndicator()}setupEventListeners(){window.addEventListener("online",()=>this.handleOnline()),window.addEventListener("offline",()=>this.handleOffline()),setInterval(()=>this.checkConnection(),3e4)}async checkConnection(){try{const e=await fetch("https://firestore.googleapis.com",{method:"HEAD",mode:"no-cors",cache:"no-cache"});this.isOnline||this.handleOnline()}catch{this.isOnline&&this.handleOffline()}}async handleOnline(){if(!this.isOnline){this.isOnline=!0,console.log("üåê Connexion r√©tablie"),this.updateIndicator(),this.notifyListeners("online"),k.success("Connexion r√©tablie. Synchronisation en cours...",3e3);try{const{saveQuizResult:e}=await F(async()=>{const{saveQuizResult:n}=await import("./services-C8kBvepO.js").then(s=>s.t);return{saveQuizResult:n}},__vite__mapDeps([0,1,2])),o=await B.getStats();if(o.pending>0){console.log(`üì§ Synchronisation de ${o.pending} op√©ration(s) en attente...`);const n={quizResult:async a=>{await e(a)}},s=await B.processQueue(n);s.success>0&&k.success(`${s.success} op√©ration(s) synchronis√©e(s) avec succ√®s`,3e3),s.failed>0&&k.warning(`${s.failed} op√©ration(s) n'ont pas pu √™tre synchronis√©es`,3e3)}}catch(e){console.error("‚ùå Erreur synchronisation:",e),k.error("Erreur lors de la synchronisation",3e3)}}}handleOffline(){this.isOnline&&(this.isOnline=!1,console.log("üì¥ Connexion perdue"),this.updateIndicator(),this.notifyListeners("offline"),k.warning("Connexion perdue. Les donn√©es seront sauvegard√©es localement.",5e3))}createIndicator(){this.indicatorElement=document.createElement("div"),this.indicatorElement.id="offline-indicator",this.indicatorElement.className="fixed bottom-4 right-4 z-50 flex items-center gap-2 px-4 py-2 rounded-lg shadow-lg transition-all duration-300",this.indicatorElement.style.display="none",document.body.appendChild(this.indicatorElement),this.updateIndicator()}updateIndicator(){this.indicatorElement&&(this.isOnline?this.indicatorElement.style.display="none":(this.indicatorElement.style.display="flex",this.indicatorElement.className="fixed bottom-4 right-4 z-50 flex items-center gap-2 px-4 py-2 rounded-lg shadow-lg bg-yellow-500 text-white transition-all duration-300",this.indicatorElement.innerHTML=`
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636a9 9 0 010 12.728m0 0l-2.829-2.829m2.829 2.829L21 21M15.536 8.464a5 5 0 010 7.072m0 0l-2.829-2.829m-4.243 2.829a4.978 4.978 0 01-1.414-2.83m-1.414 5.658a9 9 0 01-2.167-9.238m7.824 2.167a1 1 0 111.414 1.414m-1.414-1.414L3 3m8.293 8.293l1.414 1.414"></path>
                </svg>
                <span class="text-sm font-medium">Mode hors ligne</span>
            `))}getStatus(){return{isOnline:this.isOnline,timestamp:Date.now()}}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach(o=>{try{o(e,this.getStatus())}catch(n){console.error("Erreur listener offline:",n)}})}}new W;console.log("Initialisation de la page d accueil...");document.addEventListener("DOMContentLoaded",Z);function Z(){console.log("üìÑ DOM charg√© - configuration du bouton de connexion...");const t=document.getElementById("google-signin-btn");t?(t.addEventListener("click",Y),console.log("‚úÖ Bouton Google configur√©")):console.warn("‚ö†Ô∏è Bouton Google non trouv√©")}async function Y(){console.log("üîê Clic sur connexion Google...");const t=P("Connexion en cours...");try{const e=await C();I(t,`Bienvenue ${e.displayName} !`,"success"),setTimeout(()=>{window.location.reload()},800)}catch(e){console.error("‚ùå Erreur connexion Google:",e);let o="Erreur lors de la connexion";e.code==="auth/popup-closed-by-user"?o="Connexion annul√©e":e.code==="auth/popup-blocked"?o="Pop-up bloqu√©e. Autorisez les pop-ups.":e.code==="auth/unauthorized-domain"?o="Domaine non autoris√© dans Firebase":e.code==="auth/network-request-failed"&&(o="Erreur r√©seau. V√©rifiez votre connexion."),I(t,o,"error")}}(function(){document.documentElement&&(document.documentElement.style.setProperty("background","#F9FAFB","important"),document.documentElement.style.setProperty("background-color","#F9FAFB","important"),document.documentElement.style.setProperty("background-image","none","important")),document.body&&(document.body.style.setProperty("background","#F9FAFB","important"),document.body.style.setProperty("background-color","#F9FAFB","important"),document.body.style.setProperty("background-image","none","important"));const t=new MutationObserver(()=>{const e=document.getElementById("main-content");e&&(e.style.setProperty("background","#F9FAFB","important"),e.style.setProperty("background-color","#F9FAFB","important"),e.style.setProperty("background-image","none","important"))});document.body&&t.observe(document.body,{childList:!0,subtree:!0})})();const h=q(),K=_;m.set("monthsData",K.map(t=>({name:t,score:null})));m.set("currentMonthIndex",h);const x={login:document.getElementById("login-view"),dashboard:document.getElementById("dashboard-view"),moduleSelection:document.getElementById("module-selection-view")},g={modulesGrid:document.getElementById("modules-grid"),annualProgressBar:document.getElementById("annual-progress-bar"),annualProgressText:document.getElementById("annual-progress-text"),moduleSelectionTitle:document.getElementById("module-selection-title"),welcomeMessage:document.getElementById("welcome-message"),userAvatar:document.getElementById("user-avatar"),userName:document.getElementById("user-name"),googleSigninBtn:document.getElementById("google-signin-btn"),signoutLink:document.getElementById("signout-link")};m.set("dashboardEventDelegationAttached",!1);function y(t){Object.values(x).forEach(e=>{e&&e.classList.add("view-hidden")}),x[t]?(x[t].classList.remove("view-hidden"),b()):console.error("‚ùå Vue non trouv√©e:",t)}function b(){if(window.forceWhiteBackground&&window.forceWhiteBackground!==b){window.forceWhiteBackground();return}const t=document.getElementById("main-content");t&&(t.style.setProperty("background","#FFFFFF","important"),t.style.setProperty("background-color","#FFFFFF","important"),t.style.setProperty("background-image","none","important")),document.body.style.setProperty("background","#FFFFFF","important"),document.body.style.setProperty("background-color","#FFFFFF","important"),document.body.style.setProperty("background-image","none","important"),document.documentElement.style.setProperty("background","#FFFFFF","important"),document.documentElement.style.setProperty("background-color","#FFFFFF","important"),document.documentElement.style.setProperty("background-image","none","important"),t&&t.classList.remove("bg-slate-100","bg-gray-100","bg-yellow-50","bg-amber-50","bg-ap-red-50"),document.body.classList.remove("bg-slate-100","bg-gray-100","bg-yellow-50","bg-amber-50","bg-ap-red-50"),document.documentElement.classList.remove("bg-slate-100","bg-gray-100","bg-yellow-50","bg-amber-50","bg-ap-red-50")}function E(t){document.querySelectorAll(".nav-link").forEach(o=>{o.classList.remove("bg-ap-accent","text-white"),o.classList.add("text-ap-silver")});const e=document.getElementById(t);e&&(e.classList.add("bg-ap-accent","text-white"),e.classList.remove("text-ap-silver"))}function J(t,e){const n=(i=>i>=90?{badgeText:"üèÜ Excellent"}:i>=75?{badgeText:"‚≠ê Tr√®s bien"}:i>=60?{badgeText:"‚úì Bien"}:{badgeText:"‚úì Passable"})(e),s=w(t),a=w(e);return`
        <div class="module-card module-card--completed">
            <div class="module-card-header">
                <div class="module-card-icon">
                    <svg fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="module-card-badge">${n.badgeText}</div>
            </div>
            <h3 class="module-card-title">${s}</h3>
            <p class="module-card-subtitle">Quiz compl√©t√©</p>
            <p class="module-card-progress-label">Score obtenu</p>
            <div class="module-card-progress-bar">
                <div class="module-card-progress-fill" style="width: ${a}%"></div>
            </div>
            <span class="text-sm font-semibold text-ap-red-dark">Score: ${a}%</span>
        </div>
    `}function X(t){return`
        <div class="module-card module-card--locked">
            <div class="module-card-header">
                <div class="module-card-icon">
                    <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    </svg>
                </div>
                <div class="module-card-badge">VERROUILL√â</div>
            </div>
            <h3 class="module-card-title">${w(t)}</h3>
            <p class="module-card-subtitle">Disponible le 1er du mois</p>
            <p class="module-card-progress-label">Progression</p>
            <div class="module-card-progress-bar">
                <div class="module-card-progress-fill" style="width: 0%"></div>
            </div>
            <span class="text-sm text-ap-gray-600">Pas encore accessible</span>
        </div>
    `}function ee(t){return`
        <div class="module-card module-card--incomplete">
            <div class="module-card-header">
                <div class="module-card-icon">
                    <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <div class="module-card-badge">√Ä COMPL√âTER</div>
            </div>
            <h3 class="module-card-title">${w(t)}</h3>
            <p class="module-card-subtitle">Mois manqu√© - Rattrapez-le !</p>
            <p class="module-card-progress-label">Progression</p>
            <div class="module-card-progress-bar">
                <div class="module-card-progress-fill" style="width: 0%"></div>
            </div>
            <span class="text-sm font-semibold text-ap-accent-medium">0% compl√©t√©</span>
        </div>
    `}function te(t){return`
        <div class="module-card module-card--active">
            <div class="module-card-header">
                <div class="module-card-icon">
                    <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                </div>
                <div class="module-card-badge">EN COURS</div>
            </div>
            <h3 class="module-card-title">${w(t)}</h3>
            <p class="module-card-subtitle">Pr√™t √† √™tre compl√©t√© !</p>
            <p class="module-card-progress-label">Progression</p>
            <div class="module-card-progress-bar">
                <div class="module-card-progress-fill" style="width: 0%"></div>
            </div>
            <button class="start-quiz-button btn-primary w-full mt-2 flex items-center justify-center gap-2">
                <span>D√©marrer</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                </svg>
            </button>
        </div>
    `}function oe(t,e){const o=w(t),n=e/12*100;return`
        <div class="module-card module-card--active" style="grid-column: 1 / -1;">
            <div class="module-card-header">
                <div class="module-card-icon">
                    <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                </div>
                <div class="module-card-badge">QUIZ MENSUEL DISPONIBLE</div>
            </div>
            <div style="display: flex; flex-direction: row; gap: 24px; align-items: flex-start;">
                <div style="flex: 1;">
                    <h3 class="module-card-title">Quiz de ${o}</h3>
                    <p class="module-card-subtitle">Votre module mensuel est pr√™t. Relevez le d√©fi et am√©liorez vos comp√©tences !</p>
                    <button class="start-quiz-button btn-primary w-full mt-4 flex items-center justify-center gap-2" style="max-width: 300px;">
                        <span>D√©marrer le quiz</span>
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                        </svg>
                    </button>
                </div>
                <div style="min-width: 200px; text-align: center; background: rgba(255, 255, 255, 0.15); padding: 20px; border-radius: 16px;">
                    <p style="color: #F9FAFB; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 12px;">
                        Progression Annuelle
                    </p>
                    <div style="background: rgba(255, 255, 255, 0.2); border-radius: 9999px; height: 16px; margin-bottom: 12px; overflow: hidden;">
                        <div id="annual-progress-bar" style="background: #FFFFFF; height: 100%; border-radius: 9999px; transition: width 0.5s; width: ${n}%;"></div>
                    </div>
                    <p id="annual-progress-text" style="color: #FFFFFF; font-size: 2rem; font-weight: 900; line-height: 1; margin-bottom: 4px;">${e}/12</p>
                    <p style="color: #F9FAFB; font-size: 0.75rem; margin: 0;">modules compl√©t√©s</p>
                </div>
            </div>
        </div>
    `}function ne(){const t=m.get("monthsData");let e=0;for(let o=h-1;o>=0&&(t[o].score!==null&&t[o].score>=60);o--)e++;return e}async function se(){try{const t=A();if(!t){console.log("‚ÑπÔ∏è Aucun utilisateur - pas de donn√©es √† charger");return}console.log("üìä Chargement des donn√©es du dashboard...");const e=await R(t.uid);e&&await O(e);const o=await H(t.uid);console.log("üìä Progression annuelle r√©cup√©r√©e:",o);const n=N();let s=m.get("monthsData");s=s.map((l,r)=>{const c=j(l.name,n);return o[c]?(console.log(`‚úÖ Mois ${l.name} (${c}): score = ${o[c].score}`),{name:l.name,score:o[c].score}):l}),m.set("monthsData",s);const a=await U(t.uid),i=document.getElementById("streak-count");i&&(i.textContent=a),console.log("‚úÖ Donn√©es du dashboard charg√©es")}catch(t){console.error("‚ùå Erreur chargement donn√©es:",t)}}async function D(){if(!g.modulesGrid){console.error("‚ùå L'√©l√©ment 'modules-grid' est introuvable.");return}b(),await se(),g.modulesGrid.innerHTML="";let t=0;const{getMonthlyQuizStatus:e}=await F(async()=>{const{getMonthlyQuizStatus:r}=await import("./quiz-CT_T8PGH.js").then(c=>c.q);return{getMonthlyQuizStatus:r}},__vite__mapDeps([2,1,0])),o=m.get("monthsData");let n=!1,s="";if(o.forEach((r,c)=>{const d=e(c,h,r.score);console.log(`üìÖ Mois ${r.name} (index=${c}): status=${d}, score=${r.score}`),d==="completed"&&t++,c===h&&!n&&(s=r.name)}),s&&!n){const r=oe(s,t);g.modulesGrid.innerHTML=r,n=!0}else g.modulesGrid.innerHTML="";o.forEach((r,c)=>{let d="";const v=e(c,h,r.score);v==="active"?d=te(r.name):v==="completed"?d=J(r.name,r.score):v==="incomplete"?d=ee(r.name):v==="locked"&&(d=X(r.name)),d&&(g.modulesGrid.innerHTML+=d)});const a=ne(),i=document.getElementById("streak-count");i&&(i.textContent=a);const l=document.getElementById("streak-badge");l&&a===0&&(l.style.display="none"),ce(),setTimeout(()=>{re(),ae(),ie()},500)}function re(){const t=document.getElementById("skills-radar-chart");t&&new Chart(t,{type:"radar",data:{labels:["Proc√©dures","Garanties","Documentation","Inspection","Entretien","R√©glementation"],datasets:[{label:"Vos Comp√©tences",data:[92,88,85,90,87,94],backgroundColor:"rgba(99, 102, 241, 0.2)",borderColor:"rgb(99, 102, 241)",borderWidth:2,pointBackgroundColor:"rgb(99, 102, 241)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgb(99, 102, 241)"}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{r:{beginAtZero:!0,max:100,ticks:{stepSize:20}}},plugins:{legend:{display:!1}}}})}function ae(){const t=document.getElementById("scores-trend-chart");if(!t)return;const o=m.get("monthsData").filter((n,s)=>s<h);new Chart(t,{type:"line",data:{labels:o.map(n=>n.name),datasets:[{label:"Score (%)",data:o.map(n=>n.score),backgroundColor:"rgba(99, 102, 241, 0.1)",borderColor:"rgb(99, 102, 241)",borderWidth:3,fill:!0,tension:.4,pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"rgb(99, 102, 241)",pointBorderColor:"#fff",pointBorderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{y:{beginAtZero:!0,max:100,ticks:{callback:function(n){return n+"%"}}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(n){return"Score: "+n.parsed.y+"%"}}}}}})}function ie(){const t=document.getElementById("activity-heatmap");if(!t)return;const e=52,o=7;let n='<div class="flex gap-1">';for(let s=0;s<e;s++){n+='<div class="flex flex-col gap-1">';for(let a=0;a<o;a++){const i=s*o+a;let l=0;i%30<28&&(l=Math.floor(Math.random()*4)+1),n+=`<div class="w-3 h-3 rounded-sm ${["bg-slate-100","bg-green-200","bg-green-400","bg-green-600","bg-green-800"][l]}" title="Activit√©"></div>`}n+="</div>"}n+="</div>",t.innerHTML=n}let L=!1;function le(){L||(L=!0,console.log("üîß Attachement des listeners de navigation (une seule fois)..."),document.getElementById("nav-dashboard")?.addEventListener("click",t=>{t.preventDefault(),y("dashboard"),E("nav-dashboard")}),document.getElementById("nav-quiz")?.addEventListener("click",t=>{t.preventDefault();const o=m.get("monthsData")[h]?.name||"ce mois";g.moduleSelectionTitle.textContent=`Quiz de ${o}`,y("moduleSelection"),E("nav-quiz")}),document.getElementById("nav-results")?.addEventListener("click",t=>{t.preventDefault();const e=t.currentTarget;window.__QUIZ_ACTIVE?confirm("Un quiz est en cours. Voulez-vous vraiment quitter ?")&&e&&e.href&&(window.location.href=e.href):e&&e.href&&(window.location.href=e.href)}),document.getElementById("nav-resources")?.addEventListener("click",t=>{t.preventDefault();const e=t.currentTarget;window.__QUIZ_ACTIVE?confirm("Un quiz est en cours. Voulez-vous vraiment quitter ?")&&e&&e.href&&(window.location.href=e.href):e&&e.href&&(window.location.href=e.href)}),console.log("‚úÖ Listeners de navigation attach√©s"))}function ce(){m.get("dashboardEventDelegationAttached")||(document.addEventListener("click",t=>{if(t.target.closest(".start-quiz-button")){t.preventDefault();const a=m.get("monthsData")[h]?.name||"ce mois";g.moduleSelectionTitle.textContent=`Quiz de ${a}`,y("moduleSelection"),E("nav-quiz");return}if(t.target.closest(".back-to-dashboard")){t.preventDefault(),y("dashboard"),E("nav-dashboard");return}const n=t.target.closest(".module-card, .module-card-professional, [data-module]");if(n){t.preventDefault();const s=n.getAttribute("data-module");s&&(console.log("üéØ Module s√©lectionn√©:",s),$(s))}}),m.set("dashboardEventDelegationAttached",!0))}function de(t){if(t){g.userName.textContent=t.displayName||"Utilisateur",g.userAvatar.src=t.photoURL||"https://placehold.co/100x100/667eea/e0e7ff?text="+(t.displayName?.[0]||"U");const e=m.get("monthsData"),o=t.displayName?.split(" ")[0]||"Utilisateur",n=e[h]?.name||"ce mois";g.welcomeMessage.textContent=`Bonjour ${o}, pr√™t √† relever votre d√©fi de ${n} ?`}}function ue(){const t=localStorage.getItem("theme")||"light";document.documentElement.classList.toggle("dark",t==="dark"),M(t)}function M(t){const e=document.getElementById("theme-icon-sun"),o=document.getElementById("theme-icon-moon"),n=document.getElementById("theme-text");t==="dark"?(e?.classList.remove("hidden"),o?.classList.add("hidden"),n&&(n.textContent="Mode Clair")):(e?.classList.add("hidden"),o?.classList.remove("hidden"),n&&(n.textContent="Mode Sombre"))}function me(){const e=(document.documentElement.classList.contains("dark")?"dark":"light")==="dark"?"light":"dark";document.documentElement.classList.toggle("dark"),localStorage.setItem("theme",e),M(e);const o=document.getElementById("theme-toggle");if(o){const n=e==="dark";o.setAttribute("aria-pressed",n?"true":"false"),o.setAttribute("aria-label",n?"D√©sactiver le mode sombre":"Activer le mode sombre")}}document.addEventListener("DOMContentLoaded",()=>{T("Dashboard","/index.html"),console.log("üöÄ Initialisation de QuizPro..."),ue(),le(),document.getElementById("theme-toggle")?.addEventListener("click",me),g.googleSigninBtn?.addEventListener("click",C),g.signoutLink?.addEventListener("click",t=>{t.preventDefault(),confirm("Voulez-vous vraiment vous d√©connecter ?")&&S()}),y("login"),z(t=>{t?(console.log("‚úÖ Utilisateur connect√©:",t.displayName),de(t),y("dashboard"),E("nav-dashboard"),D()):(console.log("üë§ Aucun utilisateur connect√©"),y("login"))}),document.addEventListener("visibilitychange",()=>{document.hidden||b()}),window.addEventListener("focus",()=>{b()}),window.addEventListener("pageshow",t=>{t.persisted&&b()}),console.log("‚úÖ QuizPro initialis√© avec succ√®s")});const Be=Object.freeze(Object.defineProperty({__proto__:null,initializeDashboard:D},Symbol.toStringTag,{value:"Module"}));export{Be as d,xe as s};
//# sourceMappingURL=main-CN0N1yKp.js.map
