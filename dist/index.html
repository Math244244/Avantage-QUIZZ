<!DOCTYPE html>
<html lang="fr" class="h-full bg-white">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="QuizPro - Formation Continue pour Concessions">
    <meta name="theme-color" content="#C41E3A">
    <title>QuizPro - Tableau de Bord</title>
    
    <!-- PWA -->
    <link rel="manifest" href="/assets/manifest-RVFyoWEp.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Preload Critical Resources -->
    <link rel="dns-prefetch" href="https://firestore.googleapis.com">
    <link rel="dns-prefetch" href="https://www.googleapis.com">
    
    <!-- CSS -->
    
    <!-- ‚úÖ SCRIPT CRITIQUE: Forcer le background blanc IMM√âDIATEMENT (avant tout le reste) -->
    <script>
        (function() {
            // Forcer le background blanc AVANT que le CSS ne soit charg√©
            document.documentElement.style.backgroundColor = '#FFFFFF';
            document.documentElement.style.backgroundImage = 'none';
            document.body && (document.body.style.backgroundColor = '#FFFFFF');
            document.body && (document.body.style.backgroundImage = 'none');
            
            // Fonction pour forcer le background blanc (appel√©e imm√©diatement et √† chaque changement)
            function forceWhiteBg() {
                const mainContent = document.getElementById('main-content');
                if (mainContent) {
                    mainContent.style.setProperty('background', '#FFFFFF', 'important');
                    mainContent.style.setProperty('background-color', '#FFFFFF', 'important');
                    mainContent.style.setProperty('background-image', 'none', 'important');
                }
                document.body && document.body.style.setProperty('background', '#FFFFFF', 'important');
                document.body && document.body.style.setProperty('background-color', '#FFFFFF', 'important');
                document.body && document.body.style.setProperty('background-image', 'none', 'important');
                document.documentElement.style.setProperty('background', '#FFFFFF', 'important');
                document.documentElement.style.setProperty('background-color', '#FFFFFF', 'important');
            }
            
            // Appeler imm√©diatement
            forceWhiteBg();
            
            // Appeler d√®s que le DOM est disponible
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', forceWhiteBg);
            } else {
                forceWhiteBg();
            }
            
            // Appeler √† chaque changement de visibilit√©
            document.addEventListener('visibilitychange', function() {
                if (!document.hidden) forceWhiteBg();
            });
            
            // Exposer la fonction globalement pour qu'elle soit appel√©e par dashboard.js
            window.forceWhiteBackground = forceWhiteBg;
        })();
    </script>
    
    <style>
        /* ‚úÖ CSS CRITIQUE: Forcer le background gris tr√®s clair AVANT le chargement JavaScript - PRIORIT√â MAXIMALE */
        html, body, #main-content, main[role="main"] {
            background: #F9FAFB !important;
            background-color: #F9FAFB !important;
            background-image: none !important;
            transition: none !important; /* D√©sactiver les transitions pour √©viter le flash */
        }
        
        /* ‚úÖ Forcer le fond gris tr√®s clair pour les √©l√©ments de base */
        .bg-slate-100, .bg-gray-100 {
            background: #F9FAFB !important;
            background-color: #F9FAFB !important;
        }
        
        /* ‚úÖ D√©sactiver les transitions de background pour √©viter le flash jaune */
        * {
            transition-property: transform, opacity, box-shadow !important;
            transition-duration: 0.3s !important;
        }
        
        /* ‚úÖ Exception: Ne pas d√©sactiver les transitions sur les backgrounds */
        html, body, #main-content, main, .dashboard-container {
            transition: none !important;
        }
        
        /* √âviter le flash of unstyled content (FOUC) */
        body {
            font-family: 'Inter', sans-serif;
            /* Fond Avantage Plus: Blanc pur */
            background: #FFFFFF !important;
            line-height: 1.6;
            letter-spacing: -0.01em;
            /* Masquer pendant le chargement */
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.15s ease-in, visibility 0s 0.15s;
        }
        
        body.loaded {
            visibility: visible;
            opacity: 1;
            transition: opacity 0.15s ease-in;
        }
        
        h1, h2, h3, h4, h5, h6 {
            letter-spacing: -0.02em;
            line-height: 1.3;
        }
        
        .view-hidden {
            display: none;
        }
        
        /* Animations de transition entre vues */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes animate-fade-in {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fade-in {
            animation: animate-fade-in 0.6s ease-out;
        }
        
        main > div:not(.view-hidden) {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Animations hover pour les cartes */
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-6px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Animation pour les cercles de progression */
        .progress-circle {
            animation: drawCircle 1.5s ease-out forwards;
        }
        
        @keyframes pulse-flame {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }
        
        .animate-pulse {
            animation: pulse-flame 2s ease-in-out infinite;
        }
        
        /* Mode Focus */
        body.focus-mode nav {
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        
        body.focus-mode main {
            margin-left: 0;
            transition: margin-left 0.3s ease;
        }
        
        /* Dark Mode */
        .dark {
            background-color: #1a202c;
            color: #e2e8f0;
        }
        
        .dark body {
            background-color: #1a202c;
            background-image: radial-gradient(#2d3748 1px, transparent 1px);
        }
        
        .dark .bg-white {
            background-color: #2d3748 !important;
        }
        
        .dark .text-slate-900 {
            color: #e2e8f0 !important;
        }
        
        .dark .text-slate-600 {
            color: #a0aec0 !important;
        }
        
        .dark .border-gray-200 {
            border-color: #4a5568 !important;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
    </style>
  <script type="module" crossorigin src="/assets/main-B9tWEUbF.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/sidebar-mobile-BvaTxjQg.js">
  <link rel="modulepreload" crossorigin href="/assets/quiz-DC566aXg.js">
  <link rel="modulepreload" crossorigin href="/assets/services-CfagOv0X.js">
  <link rel="modulepreload" crossorigin href="/assets/admin-BqW1z8Wp.js">
  <link rel="stylesheet" crossorigin href="/assets/sidebar-mobile-C6tguhGn.css">
  <link rel="stylesheet" crossorigin href="/assets/main-CkpSfDvD.css">
</head>
<body class="h-full" style="margin: 0; padding: 0; overflow-x: hidden; display: flex;">

    <!-- Skip to main content (Accessibilit√©) -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-6 focus:py-3 focus:bg-ap-red-primary focus:text-white focus:rounded-lg focus:font-bold focus:shadow-xl focus:ring-4 focus:ring-ap-silver">
        Aller au contenu principal
    </a>

    <!-- üì± BOUTON HAMBURGER MOBILE -->
    <button id="sidebar-toggle-btn" class="sidebar-toggle-btn" aria-label="Ouvrir le menu" aria-expanded="false">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>

    <!-- üì± OVERLAY MOBILE (ferme la sidebar au clic) -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <!-- BARRE LAT√âRALE DE NAVIGATION - AVANTAGE PLUS -->
    <nav class="sidebar" aria-label="Navigation principale" role="navigation">
        <!-- Logo Avantage Plus -->
        <div class="sidebar-logo-container">
            <!-- Logo de l'entreprise -->
            <img src="/assets/logo-avantage-plus-white-on-red-CbsdVyyy.png" 
                 alt="Avantage Plus Logo" 
                 class="sidebar-logo"
                 width="150"
                 height="150"
                 decoding="async"
                 onerror="this.onerror=null; this.style.display='none'; const fallback = this.nextElementSibling; if(fallback) fallback.style.display='flex';">
            <!-- Fallback si logo non trouv√© -->
            <div class="sidebar-logo sidebar-logo-fallback" style="display: none; background: var(--ap-red-primary); border-radius: 50%; align-items: center; justify-content: center; color: white; font-size: 3rem; font-weight: 900; width: 150px; height: 150px;">
                AP
            </div>
            <p class="sidebar-brand-text">QUIZPRO</p>
        </div>
        <!-- Navigation Items -->
        <div class="sidebar-nav">
            <a href="#" id="nav-dashboard" class="sidebar-item active" role="menuitem" aria-current="page" data-index="1">
                <span class="sidebar-item-icon">
                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg>
                </span>
                <span class="sidebar-item-text">Tableau de Bord</span>
            </a>
            
            <a href="#" id="nav-quiz" class="sidebar-item nav-link" role="menuitem" data-index="2">
                <span class="sidebar-item-icon">
                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                </span>
                <span class="sidebar-item-text">Quiz</span>
            </a>
            
            <a href="/results.html" id="nav-results" class="sidebar-item nav-link" data-index="3">
                <span class="sidebar-item-icon">
                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" /></svg>
                </span>
                <span class="sidebar-item-text">Mes R√©sultats</span>
            </a>
            
            <a href="/resources.html" id="nav-resources" class="sidebar-item nav-link" data-index="4">
                <span class="sidebar-item-icon">
                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v11.494m0 0l-2.47-2.47m2.47 2.47l2.47-2.47M5 12H4a1 1 0 00-1 1v4a1 1 0 001 1h1m14-5h1a1 1 0 011 1v4a1 1 0 01-1 1h-1M5 12a2 2 0 012-2h10a2 2 0 012 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h10a2 2 0 002-2v-4a2 2 0 00-2-2" /></svg>
                </span>
                <span class="sidebar-item-text">Ressources</span>
            </a>
            
            <!-- Admin Link (hidden by default) -->
            <a href="/admin.html" id="nav-admin-item" class="sidebar-item nav-link hidden" data-index="5">
                <span class="sidebar-item-icon">
                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                </span>
                <span class="sidebar-item-text">Gestion Admin</span>
                <span class="sidebar-item-badge">ADMIN</span>
            </a>
        </div>
        <!-- Footer avec Profile -->
        <div class="sidebar-footer">
            <!-- Badge Admin (masqu√© par d√©faut) -->
            <div id="admin-badge-nav" class="sidebar-admin-badge hidden">
                <span class="sidebar-admin-badge-icon">üëë</span>
                Administrateur
            </div>
            
            <!-- User Profile -->
            <div id="user-profile" class="sidebar-user-profile">
                <img id="user-avatar" class="sidebar-user-avatar" src="https://placehold.co/100x100/C41E3A/FFFFFF?text=U" alt="Avatar utilisateur">
                <div class="sidebar-user-info">
                    <p id="user-name" class="sidebar-user-name">Chargement...</p>
                    <button id="signout-link" class="sidebar-user-role" style="background: none; border: none; cursor: pointer;">D√©connexion</button>
                </div>
            </div>
            
            <!-- Theme Toggle (optionnel) -->
            <button id="theme-toggle" data-theme-toggle class="sidebar-theme-toggle" aria-pressed="false" aria-label="Activer le mode sombre">
                <svg aria-hidden="true" id="theme-icon-sun" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
                <svg aria-hidden="true" id="theme-icon-moon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                </svg>
            </button>
        </div>
    </nav>

    <!-- CONTENU PRINCIPAL -->
    <main role="main" id="main-content" class="h-full overflow-y-auto" style="background: #F9FAFB; flex: 1; position: relative; padding: 0; margin: 0;">

        <!-- VUE: CONNEXION -->
        <div id="login-view" class="view-hidden">
            <div class="min-h-screen flex items-center justify-center px-4 relative overflow-hidden" style="background: linear-gradient(135deg, #F8F9FA 0%, #E9ECEF 50%, #F8F9FA 100%);">
                <!-- Effets de fond d√©coratifs -->
                <div class="absolute inset-0 overflow-hidden pointer-events-none">
                    <div class="absolute top-0 right-0 w-96 h-96 bg-ap-red-primary/5 rounded-full blur-3xl -mr-48 -mt-48"></div>
                    <div class="absolute bottom-0 left-0 w-96 h-96 bg-ap-silver/5 rounded-full blur-3xl -ml-48 -mb-48"></div>
                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-ap-red-primary/3 rounded-full blur-2xl"></div>
                </div>
                
                <div class="max-w-md w-full relative z-10">
                    <!-- Logo anim√© -->
                    <div class="text-center mb-8 animate-fade-in" style="animation: fadeInUp 0.6s ease-out;">
                        <div class="inline-flex items-center justify-center w-24 h-24 rounded-3xl shadow-2xl mb-6 transform hover:scale-110 transition-all duration-300 relative" style="background: var(--ap-gradient-primary); box-shadow: 0 20px 60px rgba(196, 30, 58, 0.3);">
                            <div class="absolute inset-0 rounded-3xl bg-gradient-to-br from-white/20 to-transparent"></div>
                            <svg aria-hidden="true" class="w-12 h-12 text-white relative z-10 drop-shadow-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                            </svg>
                        </div>
                        <h1 class="text-6xl font-black mb-3 gradient-text-primary" style="background: linear-gradient(135deg, #C41E3A 0%, #C0C7D0 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-shadow: 0 2px 20px rgba(196, 30, 58, 0.2);">QuizPro</h1>
                        <p class="text-xl text-slate-700 font-semibold">by Avantage Plus</p>
                    </div>
                    
                    <!-- Carte de connexion -->
                    <div class="bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl p-10 border-2 border-white/50 relative overflow-hidden" style="box-shadow: 0 20px 60px rgba(196, 30, 58, 0.15), 0 0 0 1px rgba(196, 30, 58, 0.1); animation: fadeInUp 0.8s ease-out 0.2s both;">
                        <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-ap-red-primary via-ap-silver to-ap-red-primary"></div>
                        <div class="space-y-6 relative z-10">
                            <div>
                                <h2 class="text-3xl font-black text-slate-900 mb-3">Bienvenue üëã</h2>
                                <p class="text-slate-600 text-lg">Connectez-vous pour acc√©der √† vos modules de formation et suivre votre progression.</p>
                            </div>
                            
                            <button id="google-signin-btn" class="group w-full btn-primary text-white font-bold py-5 px-8 rounded-xl shadow-xl hover:shadow-2xl transition-all duration-300 flex items-center justify-center gap-3 transform hover:-translate-y-2 hover:scale-105 relative overflow-hidden" aria-label="Se connecter avec Google" style="background: var(--ap-gradient-primary); box-shadow: 0 10px 30px rgba(196, 30, 58, 0.3);">
                                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                                <svg aria-hidden="true" class="w-7 h-7 group-hover:rotate-12 transition-transform duration-300 relative z-10" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                                </svg>
                                <span class="text-lg relative z-10">Connexion avec Google</span>
                            </button>
                            
                        </div>
                    </div>
                    
                    <!-- Footer info -->
                    <div class="mt-8 text-center" style="animation: fadeInUp 1s ease-out 0.4s both;">
                        <p class="text-sm text-slate-600 font-medium flex items-center justify-center gap-2">
                            <svg aria-hidden="true" class="w-5 h-5 text-ap-red-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                            </svg>
                            Connexion s√©curis√©e par Firebase
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- VUE: TABLEAU DE BORD -->
        <div id="dashboard-view" class="view-hidden" style="margin: 0; padding: 0; width: 100%; height: 100%;">
            <div class="dashboard-container" style="margin: 0; padding: 0; width: 100%; height: 100%;">
                
                <!-- Banni√®re de Marque Avantage Plus -->
                <div class="brand-banner">
                    <img src="/assets/Bandeau%20AVEX-D3dr9lkU.png" alt="Protection M√©canique Exceptionnelle - Avantage Plus" class="banner-image">
                </div>
                
                
                <!-- Header Avantage Plus - Fond Sombre (Cadre en L) -->
                <header class="dashboard-header">
                    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
                        <div>
                            <h2 class="dashboard-title">Tableau de Bord</h2>
                            <p id="welcome-message" class="dashboard-subtitle">Bienvenue. Voici votre parcours de formation 2025.</p>
                        </div>
                        <!-- Streak Badge - Adapt√© pour fond sombre -->
                        <div id="streak-badge" class="group card-hover bg-white/10 backdrop-blur-sm text-white px-8 py-5 rounded-2xl shadow-lg flex items-center gap-4 cursor-pointer transform hover:scale-105 transition-all duration-300 border border-white/20">
                            <div class="text-5xl animate-pulse group-hover:scale-125 transition-transform">üî•</div>
                            <div>
                                <div class="text-3xl font-bold" id="streak-count">10</div>
                                <div class="text-sm font-medium opacity-90">S√©rie active</div>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Zone de Contenu (Gris Clair) -->
                <div class="dashboard-content">
                    <!-- Grille des modules mensuels - Avantage Plus -->
                    <div class="mb-8">
                        <div class="modules-section-header">
                            <svg aria-hidden="true" class="modules-section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            <h3 class="modules-section-title">Vos Modules 2025</h3>
                        </div>
                        <div id="modules-grid" class="modules-grid">
                            <!-- La Hero Card sera g√©n√©r√©e en premi√®re position par JavaScript -->
                            <!-- Les autres cartes seront g√©n√©r√©es par JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VUE: S√âLECTION DES MODULES -->
        <div id="module-selection-view" class="view-hidden">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                <!-- Header avec breadcrumb - AVANTAGE PLUS -->
                <div class="mb-10">
                    <button class="back-to-dashboard group inline-flex items-center gap-2 text-ap-red-primary hover:text-ap-red-dark font-medium mb-4 transition-colors">
                        <svg aria-hidden="true" class="w-5 h-5 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                        </svg>
                        Retour au tableau de bord
                    </button>
                    <h2 id="module-selection-title" class="text-5xl font-bold text-ap-red-primary mb-3" style="text-shadow: 0 2px 10px rgba(196, 30, 58, 0.2);">Quiz de Novembre</h2>
                    <h2 class="text-2xl font-bold text-slate-900 mb-2">S√©lection des modules</h2>
                    <p class="text-xl text-slate-600">Choisissez votre domaine d'expertise et d√©marrez votre √©valuation</p>
                </div>

                <!-- Grille de s√©lection des 4 modules - GRILLE 2X2 STYLE TABLEAU DE BORD -->
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 32px; max-width: 900px; margin: 40px auto; padding: 0 20px;">
                    <!-- Module AUTO -->
                    <button type="button" data-module="auto" style="background: #FFFFFF; border-radius: 16px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: none; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; aspect-ratio: 1; transition: all 0.2s ease-out;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.07)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.05)';">
                        <svg style="width: 64px; height: 64px; color: #DC2626; margin-bottom: 16px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
                        </svg>
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: #1F2937; margin-bottom: 4px;">Auto</h3>
                        <p style="font-size: 0.875rem; color: #6B7280; margin-bottom: 0;">AT-AVE-AVEX</p>
                    </button>
                    
                    <!-- Module LOISIR -->
                    <button type="button" data-module="loisir" style="background: #FFFFFF; border-radius: 16px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: none; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; aspect-ratio: 1; transition: all 0.2s ease-out;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.07)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.05)';">
                        <svg style="width: 64px; height: 64px; color: #3B82F6; margin-bottom: 16px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z M12 6c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6z"/>
                        </svg>
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: #1F2937; margin-bottom: 4px;">Loisir</h3>
                        <p style="font-size: 0.875rem; color: #6B7280; margin-bottom: 0;">VTT, Motoneige</p>
                    </button>
                    
                    <!-- Module VR -->
                    <button type="button" data-module="vr" style="background: #FFFFFF; border-radius: 16px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: none; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; aspect-ratio: 1; transition: all 0.2s ease-out;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.07)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.05)';">
                        <svg style="width: 64px; height: 64px; color: #6366F1; margin-bottom: 16px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 8.69V6c0-1.1-.9-2-2-2h-3.32c-.4-.68-1.04-1.23-1.79-1.58L12 2 8.11 2.42C7.36 2.77 6.72 3.32 6.32 4H3c-1.1 0-2 .9-2 2v2.69A5.006 5.006 0 0 0 0 13v5c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h18v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-5a5.006 5.006 0 0 0-1-3.31Z"/>
                        </svg>
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: #1F2937; margin-bottom: 4px;">VR</h3>
                        <p style="font-size: 0.875rem; color: #6B7280; margin-bottom: 0;">V√©hicules R√©cr√©atifs</p>
                    </button>
                    
                    <!-- Module TRACTEUR -->
                    <button type="button" data-module="tracteur" style="background: #FFFFFF; border-radius: 16px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: none; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; aspect-ratio: 1; transition: all 0.2s ease-out;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.07)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.05)';">
                        <svg style="width: 64px; height: 64px; color: #10B981; margin-bottom: 16px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2ZM5 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2Z"/>
                            <path d="M19 8h-1V7c0-1.1-.9-2-2-2h-2c0-1.1-.9-2-2-2H8C6.9 3 6 3.9 6 5v1H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2zM8 5h8v3H8V5zm11 14H5v-2h14v2zm0-5H5V8h14v6z"/>
                        </svg>
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: #1F2937; margin-bottom: 4px;">Tracteur</h3>
                        <p style="font-size: 0.875rem; color: #6B7280; margin-bottom: 0;">√âquipement Agricole</p>
                    </button>
                </div>
            </div>
        </div>

    </main>

    <!-- √âviter le FOUC (Flash of Unstyled Content) -->
    <script>
        // R√©v√©ler la page m√™me si l'√©v√©nement load est retard√© (ex: fonts externes bloqu√©es en CI)
        (function() {
            let revealed = false;

            function reveal() {
                if (revealed) return;
                revealed = true;
                document.body.classList.add('loaded');
            }

            function cssReadyCheck() {
                try {
                    // V√©rifier qu'une classe Tailwind de base est appliqu√©e
                    const probe = document.createElement('div');
                    probe.style.position = 'absolute';
                    probe.style.visibility = 'hidden';
                    probe.className = 'w-6 h-6'; // 1.5rem = 24px si Tailwind est appliqu√©
                    document.documentElement.appendChild(probe);
                    const size = probe.getBoundingClientRect();
                    probe.remove();
                    return Math.round(size.width) === 24 && Math.round(size.height) === 24;
                } catch (e) {
                    return false;
                }
            }

            function waitForCSSThenReveal() {
                if (revealed) return;
                if (cssReadyCheck()) return reveal();

                // Boucle rAF avec garde-fou temps max (~1.2s)
                const start = performance.now();
                const maxMs = 1200;
                function tick() {
                    if (revealed) return;
                    if (cssReadyCheck() || performance.now() - start > maxMs) return reveal();
                    requestAnimationFrame(tick);
                }
                requestAnimationFrame(tick);
            }

            // Fallback ultime: forcer l'affichage apr√®s 1.5s
            const forceTimer = setTimeout(reveal, 1500);
            const clearForce = () => { if (forceTimer) clearTimeout(forceTimer); };

            if (document.readyState === 'complete' || document.readyState === 'interactive') {
                waitForCSSThenReveal();
            } else {
                document.addEventListener('DOMContentLoaded', waitForCSSThenReveal, { once: true });
                window.addEventListener('load', waitForCSSThenReveal, { once: true });
            }
        })();
    </script>

    <!-- Firebase & App Scripts -->
    <!-- Gestionnaires d'erreurs et retry (Section 1 - Architecture) -->
    
    <!-- Service Worker: d√©sactiv√© en localhost pour √©viter le cache en dev -->
    <script>
        (function() {
            if (!('serviceWorker' in navigator)) return;

            const isLocal = ['localhost', '127.0.0.1'].includes(location.hostname) || location.hostname.endsWith('.local');

            if (isLocal) {
                // Unregister tous les SW en dev pour √©viter les caches obsol√®tes
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    registrations.forEach(reg => reg.unregister());
                    console.log('üßπ Service Workers d√©senregistr√©s en dev');
                });
            } else {
                // Production: enregistrer le SW
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/service-worker.js')
                        .then(() => console.log('‚úÖ Service Worker enregistr√©'))
                        .catch(err => console.log('‚ùå Erreur SW:', err));
                });
            }
        })();
    </script>

    <!-- üì± Sidebar Mobile Manager -->

</body>
</html>
