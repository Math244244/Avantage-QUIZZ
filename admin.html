<!DOCTYPE html>
<html lang="fr" class="h-full bg-slate-100">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="QuizPro - Interface Administrateur">
    <title>QuizPro - Administration</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/output.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/micro-interactions.css">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafd;
            background-image: radial-gradient(#dbeafe 1px, transparent 1px);
            background-size: 16px 16px;
        }
        
        .tab-hidden {
            display: none;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body class="h-full">

    <div class="min-h-screen bg-slate-100">
        <!-- Header -->
        <header class="bg-gradient-to-r from-indigo-600 to-purple-600 shadow-lg">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <a href="/index.html" class="text-white hover:text-indigo-100 transition">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                            </svg>
                        </a>
                        <div>
                            <h1 class="text-3xl font-bold text-white">Interface Administrateur</h1>
                            <p class="text-indigo-100 text-sm">Gestion complete de la plateforme QuizPro</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <div id="admin-profile" class="flex items-center gap-3 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg">
                            <img id="admin-avatar" class="w-10 h-10 rounded-full" src="https://placehold.co/100x100/667eea/fff?text=A" alt="Admin">
                            <div class="text-right">
                                <p id="admin-name" class="text-sm font-semibold text-white">Admin</p>
                                <p class="text-xs text-indigo-100">üî∞ Administrateur</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Tabs Navigation -->
        <div class="bg-white shadow">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <nav class="flex gap-8" role="tablist">
                    <button 
                        id="tab-dashboard-btn" 
                        class="tab-btn py-4 px-2 border-b-2 border-indigo-600 text-indigo-600 font-semibold text-sm focus:outline-none" 
                        role="tab" 
                        aria-selected="true"
                        aria-controls="tab-dashboard">
                        üìä Dashboard
                    </button>
                    <button 
                        id="tab-questions-btn" 
                        class="tab-btn py-4 px-2 border-b-2 border-transparent text-slate-600 hover:text-slate-900 hover:border-slate-300 font-semibold text-sm focus:outline-none transition" 
                        role="tab" 
                        aria-selected="false"
                        aria-controls="tab-questions">
                        üìù Questions du Quiz
                    </button>
                    <button 
                        id="tab-users-btn" 
                        class="tab-btn py-4 px-2 border-b-2 border-transparent text-slate-600 hover:text-slate-900 hover:border-slate-300 font-semibold text-sm focus:outline-none transition" 
                        role="tab" 
                        aria-selected="false"
                        aria-controls="tab-users">
                        üë• Gestion des Utilisateurs
                    </button>
                </nav>
            </div>
        </div>

        <!-- Tab Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

            <!-- TAB: Dashboard -->
            <div id="tab-dashboard" class="tab-content" role="tabpanel">
                
                <!-- Header avec boutons d'action -->
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-3xl font-bold text-slate-900">üìä Dashboard Administrateur</h2>
                    <div class="flex gap-2">
                        <button id="refresh-dashboard-btn" class="px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                            Actualiser
                        </button>
                        <button id="export-pdf-btn" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                            </svg>
                            Export PDF
                        </button>
                        <button id="export-csv-btn" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            Export CSV
                        </button>
                    </div>
                </div>

                <!-- Statistiques Globales -->
                <div id="global-stats-cards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Cartes g√©n√©r√©es dynamiquement -->
                </div>

                <!-- Graphiques -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <!-- Graphique de progression -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-slate-900 mb-4">üìà √âvolution sur 30 jours</h3>
                        <div class="h-64">
                            <canvas id="chart-progress"></canvas>
                        </div>
                    </div>

                    <!-- Graphique par modules -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-slate-900 mb-4">üìä R√©partition par module</h3>
                        <div class="h-64">
                            <canvas id="chart-modules"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Graphique d'activit√© -->
                <div class="bg-white rounded-xl shadow-md p-6 mb-8">
                    <h3 class="text-lg font-bold text-slate-900 mb-4">üìÖ Activit√© des 7 derniers jours</h3>
                    <div class="h-64">
                        <canvas id="chart-activity"></canvas>
                    </div>
                </div>

                <!-- Top 10 & Activit√© R√©cente -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Top 10 Utilisateurs -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-slate-900 mb-4 flex items-center gap-2">
                            <span>üèÜ</span>
                            Top 10 Utilisateurs
                        </h3>
                        <div id="top-users-list" class="space-y-3">
                            <!-- Liste g√©n√©r√©e dynamiquement -->
                        </div>
                    </div>

                    <!-- Activit√© R√©cente -->
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h3 class="text-lg font-bold text-slate-900 mb-4 flex items-center gap-2">
                            <span>üïê</span>
                            Activit√© R√©cente
                        </h3>
                        <div id="recent-activity-list" class="space-y-2 max-h-96 overflow-y-auto">
                            <!-- Liste g√©n√©r√©e dynamiquement -->
                        </div>
                    </div>
                </div>

            </div>

            <!-- TAB: Questions -->
            <div id="tab-questions" class="tab-content tab-hidden" role="tabpanel">
                
                <!-- Section: Cr√©er une Question -->
                <section class="bg-white rounded-xl shadow-md p-6 mb-8">
                    <h2 class="text-2xl font-bold text-slate-900 mb-6 flex items-center gap-2">
                        <span>‚ûï</span> Cr√©er une Nouvelle Question
                    </h2>
                    
                    <form id="create-question-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Module *</label>
                                <select name="module" required class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    <option value="">S√©lectionner...</option>
                                    <option value="auto">üöó Auto</option>
                                    <option value="loisir">üèîÔ∏è Loisir</option>
                                    <option value="vr">üöê VR</option>
                                    <option value="tracteur">üöú Tracteur</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Mois *</label>
                                <select name="month" required class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    <option value="">S√©lectionner...</option>
                                    <option value="1">Janvier</option>
                                    <option value="2">F√©vrier</option>
                                    <option value="3">Mars</option>
                                    <option value="4">Avril</option>
                                    <option value="5">Mai</option>
                                    <option value="6">Juin</option>
                                    <option value="7">Juillet</option>
                                    <option value="8">Ao√ªt</option>
                                    <option value="9">Septembre</option>
                                    <option value="10">Octobre</option>
                                    <option value="11">Novembre</option>
                                    <option value="12">D√©cembre</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Ann√©e *</label>
                                <input type="number" name="year" value="2025" min="2024" max="2030" required class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Question * (min 10 caract√®res)</label>
                            <textarea name="question" rows="3" required minlength="10" placeholder="Entrez votre question ici..." class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-3">Options de r√©ponse * (4 options)</label>
                            <div class="space-y-3">
                                <div class="flex items-center gap-3">
                                    <span class="font-bold text-slate-700 w-6">A)</span>
                                    <input type="text" name="option1" required minlength="2" placeholder="Premi√®re option" class="flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                </div>
                                <div class="flex items-center gap-3">
                                    <span class="font-bold text-slate-700 w-6">B)</span>
                                    <input type="text" name="option2" required minlength="2" placeholder="Deuxi√®me option" class="flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                </div>
                                <div class="flex items-center gap-3">
                                    <span class="font-bold text-slate-700 w-6">C)</span>
                                    <input type="text" name="option3" required minlength="2" placeholder="Troisi√®me option" class="flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                </div>
                                <div class="flex items-center gap-3">
                                    <span class="font-bold text-slate-700 w-6">D)</span>
                                    <input type="text" name="option4" required minlength="2" placeholder="Quatri√®me option" class="flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-3">Bonne r√©ponse *</label>
                            <div class="flex gap-6">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="radio" name="correctAnswer" value="0" required class="w-4 h-4 text-indigo-600">
                                    <span class="font-semibold text-slate-700">A</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="radio" name="correctAnswer" value="1" class="w-4 h-4 text-indigo-600">
                                    <span class="font-semibold text-slate-700">B</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="radio" name="correctAnswer" value="2" class="w-4 h-4 text-indigo-600">
                                    <span class="font-semibold text-slate-700">C</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="radio" name="correctAnswer" value="3" class="w-4 h-4 text-indigo-600">
                                    <span class="font-semibold text-slate-700">D</span>
                                </label>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Explication * (min 20 caract√®res)</label>
                            <textarea name="explanation" rows="4" required minlength="20" placeholder="Expliquez pourquoi c'est la bonne r√©ponse..." class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"></textarea>
                        </div>
                        
                        <div id="create-question-error"></div>
                        
                        <div class="flex gap-3">
                            <button type="reset" class="px-6 py-3 border border-slate-300 text-slate-700 font-semibold rounded-lg hover:bg-slate-50 transition">
                                Annuler
                            </button>
                            <button type="submit" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition">
                                ‚úì Cr√©er la Question
                            </button>
                        </div>
                    </form>
                </section>

                <!-- Section: Import JSON -->
                <section class="bg-white rounded-xl shadow-md p-6 mb-8">
                    <h2 class="text-2xl font-bold text-slate-900 mb-6 flex items-center gap-2">
                        <span>üì•</span> Importer des Questions depuis JSON
                    </h2>
                    
                    <div class="border-2 border-dashed border-slate-300 rounded-xl p-8 text-center hover:border-indigo-500 transition">
                        <svg class="w-16 h-16 mx-auto text-slate-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        <p class="text-lg font-semibold text-slate-700 mb-2">Glissez votre fichier JSON ici</p>
                        <p class="text-sm text-slate-500 mb-4">ou</p>
                        <input type="file" id="json-file-input" accept=".json" class="hidden">
                        <button id="browse-json-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-6 rounded-lg transition">
                            üìé Parcourir les fichiers
                        </button>
                        <p class="text-xs text-slate-400 mt-4">Format attendu: .json</p>
                    </div>
                    
                    <div id="json-preview" class="mt-6"></div>
                </section>

                <!-- Section: Liste des Questions -->
                <section class="bg-white rounded-xl shadow-md p-6 mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-slate-900 flex items-center gap-2">
                            <span>üìö</span> Questions Existantes
                        </h2>
                    </div>
                    
                    <!-- Filtres -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <select id="filter-module" class="px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            <option value="">Tous les modules</option>
                            <option value="auto">üöó Auto</option>
                            <option value="loisir">üèîÔ∏è Loisir</option>
                            <option value="vr">üöê VR</option>
                            <option value="tracteur">üöú Tracteur</option>
                        </select>
                        <select id="filter-month" class="px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            <option value="">Tous les mois</option>
                            <option value="1">Janvier</option>
                            <option value="2">F√©vrier</option>
                            <option value="3">Mars</option>
                            <option value="4">Avril</option>
                            <option value="5">Mai</option>
                            <option value="6">Juin</option>
                            <option value="7">Juillet</option>
                            <option value="8">Ao√ªt</option>
                            <option value="9">Septembre</option>
                            <option value="10">Octobre</option>
                            <option value="11">Novembre</option>
                            <option value="12">D√©cembre</option>
                        </select>
                        <select id="filter-year" class="px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            <option value="">Toutes les ann√©es</option>
                            <option value="2025" selected>2025</option>
                            <option value="2024">2024</option>
                            <option value="2026">2026</option>
                        </select>
                        <input type="text" id="search-questions" placeholder="üîç Rechercher..." class="px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                    </div>
                    
                    <!-- Liste -->
                    <div id="questions-list" class="space-y-4 mb-6">
                        <!-- Les questions seront charg√©es ici -->
                    </div>
                    
                    <!-- Pagination -->
                    <div class="flex items-center justify-between border-t border-slate-200 pt-4">
                        <button id="prev-page-btn" class="px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                            ‚Üê Pr√©c√©dent
                        </button>
                        <span id="page-info" class="text-sm text-slate-600 font-medium">Page 1/1</span>
                        <button id="next-page-btn" class="px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed">
                            Suivant ‚Üí
                        </button>
                    </div>
                </section>

                <!-- Section: Statistiques -->
                <section id="questions-stats">
                    <!-- Les stats seront charg√©es ici -->
                </section>

            </div>

            <!-- TAB: Utilisateurs -->
            <div id="tab-users" class="tab-content tab-hidden" role="tabpanel">
                
                <!-- Section: Cr√©er un Utilisateur -->
                <section class="bg-white rounded-xl shadow-md p-6 mb-8">
                    <h2 class="text-2xl font-bold text-slate-900 mb-6 flex items-center gap-2">
                        <span>‚ûï</span> Cr√©er un Nouvel Utilisateur
                    </h2>
                    
                    <form id="create-user-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Nom complet *</label>
                                <input type="text" name="displayName" required minlength="3" placeholder="Ex: Jean Dupont" 
                                       class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Email *</label>
                                <input type="email" name="email" required placeholder="exemple@email.com" 
                                       class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Mot de passe temporaire *</label>
                                <input type="password" name="password" required minlength="6" placeholder="Min 6 caract√®res" 
                                       class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                <p class="text-xs text-slate-500 mt-1">L'utilisateur devra changer ce mot de passe √† la premi√®re connexion</p>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">R√¥le *</label>
                                <select name="role" required class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    <option value="user">üë§ Utilisateur Standard</option>
                                    <option value="admin">üî∞ Administrateur</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="create-user-error" class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"></div>
                        <div id="create-user-success" class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg"></div>
                        
                        <div class="flex gap-4">
                            <button type="submit" id="create-user-btn" class="flex-1 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-6 py-3 rounded-lg font-semibold transition shadow-md hover:shadow-lg">
                                ‚ûï Cr√©er l'utilisateur
                            </button>
                            <button type="button" id="generate-password-btn" class="px-6 py-3 border-2 border-indigo-600 text-indigo-600 rounded-lg font-semibold hover:bg-indigo-50 transition">
                                üé≤ G√©n√©rer un mot de passe
                            </button>
                        </div>
                    </form>
                </section>
                
                <!-- Section: Liste des Utilisateurs -->
                <section class="bg-white rounded-xl shadow-md p-6 mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-slate-900 flex items-center gap-2">
                            <span>üë•</span> Utilisateurs
                        </h2>
                    </div>
                    
                    <!-- Filtres -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <select id="filter-user-role" class="px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            <option value="">Tous les r√¥les</option>
                            <option value="user">üë§ Users</option>
                            <option value="admin">üî∞ Admins</option>
                        </select>
                        <select id="filter-user-status" class="px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            <option value="all">Tous les statuts</option>
                            <option value="active">Actifs</option>
                            <option value="inactive">Inactifs</option>
                        </select>
                        <input type="text" id="search-users" placeholder="üîç Rechercher par nom ou email..." class="px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                    </div>
                    
                    <!-- Liste -->
                    <div id="users-list" class="space-y-4">
                        <!-- Les utilisateurs seront charg√©s ici -->
                    </div>
                </section>

                <!-- Section: Statistiques -->
                <section id="users-stats">
                    <!-- Les stats seront charg√©es ici -->
                </section>

            </div>

        </main>
    </div>

    <!-- Scripts externes: Chart.js et jsPDF -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Scripts Firebase & App -->
    <script type="module" src="js/toast.js"></script>
    <script type="module" src="js/tooltip.js"></script>
    <script type="module">
        import { requireAdmin } from './js/admin-auth-guard.js';
        import { initQuestionsManager } from './js/admin-questions.js';
        import { initUsersManager } from './js/admin-users.js';
        import { initAdminDashboard } from './js/admin-dashboard.js';
        import { auth } from './js/firebase-config.js';
        import { toast } from './js/toast.js';
        import { tooltip } from './js/tooltip.js';
        
        // V√©rifier les permissions admin au chargement
        requireAdmin().then(user => {
            console.log('Admin authentifi√©:', user.email);
            toast.success(`Bienvenue ${user.displayName || user.email} !`, 3000);
            
            // Afficher les infos admin
            const adminName = document.getElementById('admin-name');
            const adminAvatar = document.getElementById('admin-avatar');
            
            if (adminName) adminName.textContent = user.displayName || user.email;
            if (adminAvatar && user.photoURL) adminAvatar.src = user.photoURL;
            
            // Initialiser les gestionnaires
            initAdminDashboard(); // Dashboard en premier
            initQuestionsManager();
            initUsersManager();
            
            // Gestion des tabs
            initTabs();
            
        }).catch(error => {
            console.error('Erreur authentification admin:', error);
            // La redirection est d√©j√† g√©r√©e par requireAdmin()
        });
        
        /**
         * Initialiser les tabs
         */
        function initTabs() {
            const dashboardBtn = document.getElementById('tab-dashboard-btn');
            const questionsBtn = document.getElementById('tab-questions-btn');
            const usersBtn = document.getElementById('tab-users-btn');
            
            const dashboardTab = document.getElementById('tab-dashboard');
            const questionsTab = document.getElementById('tab-questions');
            const usersTab = document.getElementById('tab-users');
            
            // Fonction pour activer un onglet
            function activateTab(activeBtn, activeTab) {
                // D√©sactiver tous les boutons
                [dashboardBtn, questionsBtn, usersBtn].forEach(btn => {
                    btn.classList.remove('border-indigo-600', 'text-indigo-600');
                    btn.classList.add('border-transparent', 'text-slate-600');
                    btn.setAttribute('aria-selected', 'false');
                });
                
                // Cacher tous les onglets
                [dashboardTab, questionsTab, usersTab].forEach(tab => {
                    tab.classList.add('tab-hidden');
                });
                
                // Activer le bouton et l'onglet s√©lectionn√©s
                activeBtn.classList.remove('border-transparent', 'text-slate-600');
                activeBtn.classList.add('border-indigo-600', 'text-indigo-600');
                activeBtn.setAttribute('aria-selected', 'true');
                activeTab.classList.remove('tab-hidden');
            }
            
            // √âv√©nements des onglets
            dashboardBtn.addEventListener('click', () => activateTab(dashboardBtn, dashboardTab));
            questionsBtn.addEventListener('click', () => activateTab(questionsBtn, questionsTab));
            usersBtn.addEventListener('click', () => activateTab(usersBtn, usersTab));
        }
    </script>

</body>
</html>
